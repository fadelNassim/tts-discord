<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TTS Discord</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ™ï¸ TTS Discord</h1>
      <p class="subtitle">Text-to-Speech with Voice Cloning</p>
    </header>

    <main>
      <div class="text-input-panel">
        <div class="quickbar">
          <div class="quickbar-left">
            <div class="form-group" style="margin-bottom: 12px;">
              <label for="serverAddress">
                <span class="label-icon">ğŸŒ</span>
                Server
              </label>
              <input
                type="text"
                id="serverAddress"
                placeholder="http://localhost:5002"
                value="http://localhost:5002"
              >
            </div>

            <div class="form-group" style="margin-bottom: 12px;">
              <label for="voiceSelect">
                <span class="label-icon">ğŸµ</span>
                Voice
              </label>
              <div class="input-with-button">
                <select id="voiceSelect" disabled>
                  <option value="">Click Refresh to load voices</option>
                </select>
                <button id="refreshVoicesBtn" class="btn-secondary" title="Refresh voices from server">Refresh</button>
              </div>
              <p class="hint">Enter = Generate Â· Shift+Enter = New line</p>
            </div>

            <div class="form-group" style="margin-bottom: 12px;">
              <label for="languageSelect">
                <span class="label-icon">ğŸŒ</span>
                Language
              </label>
              <select id="languageSelect">
                <option value="Auto">Auto</option>
                <option value="Chinese">Chinese</option>
                <option value="English">English</option>
                <option value="Japanese">Japanese</option>
                <option value="Korean">Korean</option>
                <option value="German">German</option>
                <option value="French">French</option>
                <option value="Russian">Russian</option>
                <option value="Portuguese">Portuguese</option>
                <option value="Spanish">Spanish</option>
                <option value="Italian">Italian</option>
              </select>
              <p class="hint">Choose a language or keep Auto for detection.</p>
            </div>
          </div>

          <div class="quickbar-right">
            <button id="generateBtn" class="btn-primary btn-generate" title="Enter = Generate, Shift+Enter = New line">
              ğŸ”Š Generate
            </button>
            <div class="checkbox-row checkbox-compact">
              <input type="checkbox" id="discordAutoPlay">
              <label for="discordAutoPlay" class="inline-label">Auto-play to Discord mic</label>
            </div>
            <div id="playbackStatus" class="playback-status idle">Playback: idle</div>
          </div>
        </div>

        <label for="textInput">
          <span class="label-icon">âœï¸</span>
          Text to Speak
        </label>
        <textarea 
          id="textInput" 
          placeholder="Type what you want to say here..."
          rows="8"
        ></textarea>

        <div id="statusMessage" class="status-message"></div>
      </div>

      <details class="settings-panel advanced-panel">
        <summary>
          <span class="summary-title">âš™ï¸ Advanced settings</span>
          <span class="summary-subtitle">Discord routing</span>
        </summary>
        <div class="advanced-content">
          <div class="form-group">
            <label>
              <span class="label-icon">ğŸ®</span>
              Discord Mic Routing
            </label>

            <div class="form-group" style="margin-top: 10px;">
              <label for="discordOsMode">OS</label>
              <select id="discordOsMode">
                <option value="auto">Auto-detect</option>
                <option value="linux">Linux</option>
                <option value="windows">Windows</option>
                <option value="macos">macOS</option>
              </select>
            </div>

            <div class="input-with-button">
              <input
                type="text"
                id="discordSinkName"
                placeholder="tts_discord_sink"
                value="tts_discord_sink"
              >
              <button id="discordSetupBtn" class="btn-secondary">Setup</button>
              <button id="discordTeardownBtn" class="btn-secondary">Restore</button>
            </div>
            <div class="form-group" style="margin-top: 10px;">
              <label for="discordWindowsCable">Windows device hint</label>
              <input
                type="text"
                id="discordWindowsCable"
                placeholder="VB-Cable (CABLE Input / CABLE Output)"
                value="CABLE"
              >
            </div>
            <p class="hint">Linux: creates a virtual mic via PipeWire/PulseAudio and can set your default input to it. Windows: install VB-Cable, set Discord input to CABLE Output, and route this app's output to CABLE Input in Windows sound settings.</p>
          </div>
        </div>
      </details>

      <details class="info-panel">
        <summary><b>ğŸ“‹ Help</b> (click to expand)</summary>
        <h3>ğŸ“‹ Instructions</h3>
        <ol>
          <li>Set your Qwen3-TTS server address (default: http://localhost:5002)</li>
          <li>Click Refresh to load voice samples from the server</li>
          <li>Choose a voice sample from the dropdown (server <code>references/</code>)</li>
          <li>Type the text you want to convert to speech</li>
          <li>Click "Generate Speech" to create the audio</li>
          <li>The audio will be saved in the audio_output folder</li>
        </ol>

        <h3>ğŸ® Discord (Automated)</h3>
        <ul>
          <li>Click <b>Setup</b> once (Linux) and set Discord Input Device to <b>Default</b></li>
          <li>Enable <b>Auto-play generated audio to Discord mic</b></li>
          <li>Generate speech â€” it will be injected into Discord automatically</li>
        </ul>
      </details>
    </main>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
